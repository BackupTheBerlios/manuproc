--
-- PostgreSQL database dump
--

\connect - jacek

SET search_path = public, pg_catalog;

DROP TRIGGER "RI_ConstraintTrigger_1752178" ON public.kunden;
DROP TRIGGER "RI_ConstraintTrigger_1752177" ON public.kunden;
ALTER TABLE ONLY public.kunden DROP CONSTRAINT kunden_pkey;
DROP INDEX public.kunden_uniq;
DROP INDEX public.kudnen_sort_idx;
DROP INDEX public.kudnen_firma_idx;
DROP TABLE public.kunden;
--
-- TOC entry 2 (OID 960848)
--

CREATE TABLE kunden (
    kundennr numeric(5,0) NOT NULL,
    sortname character varying(30),
    idnr character varying(20),
    firma character varying(60) NOT NULL,
    postanwvor character varying(40),
    strasse character varying(35),
    postanwnach character varying(40),
    hsnr character varying(7),
    plz character varying(10),
    postfach character varying(20),
    postfplz character varying(10),
    ort character varying(30),
    planumsatz numeric(8,0),
    umsatz numeric(10,2),
    mitarbeiter numeric(5,0),
    kundenumsatz numeric(10,2),
    stand timestamp(0) with time zone,
    flaeche numeric(5,0),
    kalkulation numeric(3,0),
    ktonr numeric(10,0),
    blz numeric(10,0),
    preisliste numeric(5,0),
    rabatt numeric(3,1) DEFAULT 0,
    notiz text,
    rechnung_an numeric(5,0),
    bankeinzug boolean DEFAULT false,
    rng_an_postfach boolean DEFAULT false,
    extbezschemaid numeric(5,0),
    extartbezid numeric(5,0),
    lieferadresse boolean DEFAULT false,
    rechnungsadresse boolean DEFAULT false,
    typ character varying(4) DEFAULT 'RL',
    verein character varying(30),
    skontofrist numeric(3,0),
    bankindex integer,
    entsorgung boolean DEFAULT false,
    waehrungid numeric(2,0),
    einzugrabatt numeric(3,1),
    lkz character varying(3),
    skontosatz numeric(3,2),
    verknr_old numeric(3,0),
    gruppennr numeric(5,0) DEFAULT 0,
    zeilenrabatt boolean,
    buchungskonto integer,
    unsere_kundennr text,
    lieferantenkonto integer,
    gegenkonto integer,
    ku_verkaeufer numeric(3,0),
    sonder_pliste integer[],
    landid integer,
    betreuer numeric(5,0),
    anz_firmenpapier integer,
    anz_weissespapier integer,
    zahlungsart numeric(3,0),
    lieferung_frei_haus boolean,
    aktiv boolean DEFAULT true,
    preisauto boolean DEFAULT true,
    showean boolean,
    auf_notiz text,
    lief_notiz text,
    rng_notiz text,
    debitorenkonto integer,
    name2 text,
    gebdatum date,
    branr integer,
    lieferung_an numeric(5,0),
    ab_an_rngadresse boolean DEFAULT false,
    verknr numeric(5,0),
    CHECK ((aktiv IS NOT NULL)),
    CONSTRAINT kunden_preisauto CHECK ((preisauto IS NOT NULL))
);


--
-- TOC entry 3 (OID 960848)
--

REVOKE ALL ON TABLE kunden FROM PUBLIC;


--
-- TOC entry 4 (OID 1752135)
--

CREATE INDEX kudnen_firma_idx ON kunden USING btree (firma);


--
-- TOC entry 5 (OID 1752136)
--

CREATE INDEX kudnen_sort_idx ON kunden USING btree (sortname);


--
-- TOC entry 7 (OID 1752137)
--

CREATE UNIQUE INDEX kunden_uniq ON kunden USING btree (sortname, ort);


--
-- TOC entry 6 (OID 960866)
--

ALTER TABLE ONLY kunden
    ADD CONSTRAINT kunden_pkey PRIMARY KEY (kundennr);


--
-- TOC entry 8 (OID 1752177)
--

CREATE CONSTRAINT TRIGGER "$1"
    AFTER DELETE ON kunden
    FROM prov_abrechnung
    NOT DEFERRABLE INITIALLY IMMEDIATE
    FOR EACH ROW
    EXECUTE PROCEDURE "RI_FKey_noaction_del" ('$1', 'prov_abrechnung', 'kunden', 'UNSPECIFIED', 'verknr', 'kundennr');


--
-- TOC entry 9 (OID 1752178)
--

CREATE CONSTRAINT TRIGGER "$1"
    AFTER UPDATE ON kunden
    FROM prov_abrechnung
    NOT DEFERRABLE INITIALLY IMMEDIATE
    FOR EACH ROW
    EXECUTE PROCEDURE "RI_FKey_noaction_upd" ('$1', 'prov_abrechnung', 'kunden', 'UNSPECIFIED', 'verknr', 'kundennr');


